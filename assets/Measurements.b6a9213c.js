import{Q as y,a as R}from"./QTr.da10a9bf.js";import{r as u,aI as m,a5 as w,u as i,P as c,a3 as C,bb as r,b as j,d as t,ac as M,bD as x,bE as f,a6 as N,a4 as D}from"./index.43b29598.js";import{Q as A}from"./QInput.50502b6a.js";import{Q as G,c as H,p as J,f as K,d as W}from"./paginations.d31396ff.js";import{a as X,Q as T}from"./QCard.287aa4cb.js";import{e as Y,a as Z}from"./excel.5d19a2ad.js";import{a as ee}from"./use-quasar.811db318.js";import{a as ae,u as te}from"./index.fe5141b8.js";import{u as se}from"./measurement-store.bfd767c0.js";import"./use-dark.ad1ce312.js";import"./QSeparator.00910b71.js";import"./rtl.e3274486.js";import"./module_calls.e16012c0.js";import"./helpers.01ee3f07.js";const $=[{name:"name",required:!0,label:"Name",align:"left",field:v=>v.name,format:v=>`${v}`,sortable:!0},{name:"user",align:"center",label:"User",field:"user",sortable:!0},{name:"created_at",align:"center",label:"Created On",field:"created_at",sortable:!0},{name:"actions",align:"center",label:"Actions",field:"created_at"}];const re={class:"q-pa-md"},le={key:0},oe={key:1},ne={class:"text-h6"},ue={class:"text-center error_msg"},we={__name:"Measurements",setup(v){const V=ee(),b=ae(),_=se(),k=J(10),n=u(!1),p=u(!1),h=u(""),g=u(""),l=u(""),Q=u(""),d=u(""),{data:q,isLoading:S,isError:E}=te("measurements",()=>_.fetchMeasurements()),U=async a=>{if(confirm(`Continue with the operation. Delete ${a.name} ?`)){const e=await _.deleteMeasurement({uuid:a.uuid});e.status==="success"?(b.refetchQueries("measurements"),o(e.message,"green","top")):o("There was an error","red","top-right")}},B=()=>{g.value="Add New Measurement",n.value=!0,p.value=!1},z=a=>{p.value=!0,g.value=`Edit ${a.name}`,l.value=a.name,Q.value=a.uuid,n.value=!0},I=async()=>{if(d.value="",l.value.trim()){const a=await _.createMeasurement({name:l.value.trim()});a.status==="success"?(b.refetchQueries("measurements"),l.value="",n.value=!1,o(a.message,"green","top")):(d.value=a.message,o(a.message,"red","top-right"))}else d.value="Name is required!",o("Name is required!","red","top-right")},L=async()=>{const a={name:l.value.trim(),uuid:Q.value};if(a.name){const s=await _.updateMeasurement(a);s.status==="success"?(b.refetchQueries("measurements"),l.value="",n.value=!1,p.value=!1,g.value="",o(s.message,"green","top")):o("There was an error","red","top-right")}else d.value="Name is required!",o("Name is required!","red","top-right")},F=()=>{n.value=!1,l.value="",Q.value="",d.value=""},o=(a,s,e)=>{V.notify({message:a,color:s,position:e})},O=a=>{const s=a.map(e=>({name:e.name,users:e.users.length,created_at:e.created_at}));Y(s,$,Z,V,"MeasurementsData")};return(a,s)=>(m(),w("div",re,[i(S)?(m(),w("div",le,"Loading measurements...")):i(E)?(m(),w("div",oe,"An error has occurred: "+c(i(E)),1)):(m(),C(G,{key:2,title:"Measurements",rows:i(q),columns:i($),pagination:i(k),"onUpdate:pagination":s[2]||(s[2]=e=>j(k)?k.value=e:null),separator:"cell","row-key":"name",filter:h.value,dense:""},{body:r(e=>[t(R,{props:e},{default:r(()=>[t(y,{key:"name",props:e},{default:r(()=>[M(c(e.row.name),1)]),_:2},1032,["props"]),t(y,{key:"user",props:e},{default:r(()=>[M(c(e.row.user),1)]),_:2},1032,["props"]),t(y,{key:"created_at",props:e},{default:r(()=>[M(c(e.row.created_at),1)]),_:2},1032,["props"]),t(y,{key:"actions",props:e},{default:r(()=>[t(x,{color:"blue",name:"edit",onClick:P=>z(e.row),style:{cursor:"pointer"},size:"20px",class:"q-mr-md"},null,8,["onClick"]),t(x,{color:"red",name:"delete",onClick:P=>U(e.row),style:{cursor:"pointer"},size:"20px"},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),"top-right":r(()=>[t(A,{borderless:"",dense:"",outlined:"",rounded:"",debounce:"300",modelValue:h.value,"onUpdate:modelValue":s[0]||(s[0]=e=>h.value=e),placeholder:"Search",class:"q-mr-md"},{append:r(()=>[t(x,{name:"search"})]),_:1},8,["modelValue"]),t(f,{onClick:B,round:"",dense:"",color:"primary",size:"small",icon:"add"}),t(f,{dense:"",flat:"",color:"primary","icon-right":"archive",label:"Export",class:"q-ml-sm","no-caps":"",onClick:s[1]||(s[1]=e=>O(i(q)))})]),_:1},8,["rows","columns","pagination","filter"])),t(H,{modelValue:n.value,"onUpdate:modelValue":s[4]||(s[4]=e=>n.value=e),persistent:""},{default:r(()=>[t(X,{style:{width:"500px"}},{default:r(()=>[t(T,null,{default:r(()=>[N("div",ne,c(g.value),1)]),_:1}),t(T,{class:"q-pt-none"},{default:r(()=>[t(A,{outlined:"",dense:"",label:"Name",modelValue:l.value,"onUpdate:modelValue":s[3]||(s[3]=e=>l.value=e)},null,8,["modelValue"])]),_:1}),N("div",ue,[N("small",null,c(d.value),1)]),t(K,{align:"right"},{default:r(()=>[t(f,{flat:"",label:"Cancel",color:"red",onClick:F}),t(W),l.value&&!p.value?(m(),C(f,{key:0,flat:"",label:"Add Measurement",color:"primary",onClick:I})):D("",!0),l.value&&p.value?(m(),C(f,{key:1,flat:"",label:"Edit Measurement",color:"primary",onClick:L})):D("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{we as default};
