import{Q as d,a as X}from"./QTr.f2b3f0cd.js";import{Q as Z}from"./QBadge.c1e0609e.js";import{r as _,j as ee,aI as c,a5 as S,u as o,P as n,a3 as Q,bb as l,b as te,d as t,ac as i,a6 as k,bD as h,bE as y,a4 as D}from"./index.bc27483f.js";import{Q as v}from"./QInput.e3697c5f.js";import{Q as ae}from"./QBtnGroup.4c23ce1f.js";import{Q as oe,a as re,p as le,d as $,b as N,c as se}from"./paginations.fcc2a0de.js";import{a as ne,Q as f}from"./QCard.7d1d294b.js";import{Q as ue}from"./QToolbar.5d923135.js";import{e as de,a as ie}from"./excel.5d19a2ad.js";import{a as me}from"./use-quasar.e5ac4fd4.js";import{a as ce,u as w}from"./index.4c42915d.js";import{p as M}from"./product_columns.33f8ffe3.js";import{u as pe}from"./product-store.32e5bc06.js";import{u as _e}from"./category-store.1d8cc859.js";import{u as fe}from"./measurement-store.b9750b5a.js";import{u as ge}from"./department-store.bdae1ff0.js";import"./use-dark.c0bb3fd4.js";import"./QSeparator.df4475a1.js";import"./rtl.f0ddda94.js";import"./module_calls.e16012c0.js";import"./helpers.01ee3f07.js";const ye={class:"q-pa-md"},ve={key:0},be={key:1},Ve={class:"text-h6"},Qe={class:"text-center error_msg"},Oe={__name:"Products",setup(ke){const U=me(),P=ce(),b=pe(),E=_e(),z=fe(),I=ge(),C=le(10),m=_(!1),g=_(!1),q=_(""),V=_(""),T=_(""),p=_("");let r=ee({name:"",quantity:1,category_id:"",buying_price:1,selling_price:1,measurement_id:"",department_id:""});const{data:x,isLoading:R,isError:B}=w("products",()=>b.fetchProducts()),{data:G}=w("categories",()=>E.fetchCategories()),{data:L}=w("measurements",()=>z.fetchMeasurements()),{data:O}=w("departments",()=>I.fetchDepartments()),Y=async s=>{if(confirm(`Continue with the operation. Delete ${s.name} ?`)){const e=await b.deleteProduct({uuid:s.uuid});e.status==="success"?(P.refetchQueries("products"),u(e.message,"green","top")):u("There was an error","red","top-right")}},j=()=>{E.categories.length===0?u("You need to create at least one PRODUCT CATEGORY in order to create products!","orange","top"):(V.value="Add New Product",m.value=!0,g.value=!1)},F=s=>{console.log(s),g.value=!0,V.value=`Edit ${s.name}`,m.value=!0},H=async()=>{p.value="";const s={name:r.name.trim(),quantity:r.quantity,selling_price:r.selling_price,buying_price:r.buying_price,category_uuid:r.category_id.uuid,department_uuid:r.department_id.uuid,measurement_uuid:r.measurement_id.uuid};if(s.name&&s.selling_price&&s.buying_price){const a=await b.createProduct(s);a.status==="success"?(P.refetchQueries("products"),r.name="",r.selling_price=1,r.buying_price=1,m.value=!1,u(a.message,"green","top")):(p.value=a.message,u(a.message,"red","top-right"))}else p.value="Name, Buying and Seeling prices  is required!",u("Name is required!","red","top-right")},J=async()=>{const s={name:product_name.value.trim(),uuid:T.value};if(s.name){const a=await b.updateProduct(s);a.status==="success"?(P.refetchQueries("products"),product_name.value="",m.value=!1,g.value=!1,V.value="",u(a.message,"green","top")):u("There was an error","red","top-right")}else p.value="Name is required!",u("Name is required!","red","top-right")},K=()=>{m.value=!1,T.value="",p.value=""},u=(s,a,e)=>{U.notify({message:s,color:a,position:e})},W=s=>{const a=s.map(e=>({name:e.name,products:e.products.length,created_at:e.created_at}));de(a,M,ie,U,"ProductsData")};return(s,a)=>(c(),S("div",ye,[o(R)?(c(),S("div",ve,"Loading products...")):o(B)?(c(),S("div",be,"An error has occurred: "+n(o(B)),1)):(c(),Q(oe,{key:2,title:"Products",rows:o(x),columns:o(M),pagination:o(C),"onUpdate:pagination":a[2]||(a[2]=e=>te(C)?C.value=e:null),separator:"cell","row-key":"name",filter:q.value,dense:""},{body:l(e=>[t(X,{props:e},{default:l(()=>[t(d,{key:"name",props:e},{default:l(()=>[i(n(e.row.name),1)]),_:2},1032,["props"]),t(d,{key:"measurement",props:e},{default:l(()=>[i(n(e.row.measurement)+" ",1),k("small",null,[t(Z,null,{default:l(()=>[i(": "+n(e.row.quantity),1)]),_:2},1024)])]),_:2},1032,["props"]),t(d,{key:"buying_price",props:e},{default:l(()=>[i(n(e.row.buying_price),1)]),_:2},1032,["props"]),t(d,{key:"selling_price",props:e},{default:l(()=>[i(n(e.row.selling_price),1)]),_:2},1032,["props"]),t(d,{key:"department",props:e},{default:l(()=>[i(n(e.row.department),1)]),_:2},1032,["props"]),t(d,{key:"category",props:e},{default:l(()=>[i(n(e.row.category),1)]),_:2},1032,["props"]),t(d,{key:"user",props:e},{default:l(()=>[i(n(e.row.user),1)]),_:2},1032,["props"]),t(d,{key:"created_at",props:e},{default:l(()=>[i(n(e.row.created_at),1)]),_:2},1032,["props"]),t(d,{key:"actions",props:e},{default:l(()=>[t(h,{color:"blue",name:"edit",onClick:A=>F(e.row),style:{cursor:"pointer"},size:"20px",class:"q-mr-md"},null,8,["onClick"]),t(h,{color:"red",name:"delete",onClick:A=>Y(e.row),style:{cursor:"pointer"},size:"20px"},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),"top-right":l(()=>[t(v,{borderless:"",dense:"",outlined:"",rounded:"",debounce:"300",modelValue:q.value,"onUpdate:modelValue":a[0]||(a[0]=e=>q.value=e),placeholder:"Search",class:"q-mr-md"},{append:l(()=>[t(h,{name:"search"})]),_:1},8,["modelValue"]),t(ae,null,{default:l(()=>{var e;return[t(y,{onClick:j,dense:"",color:"blue",size:"small",icon:"add",label:"Add"}),((e=o(x))==null?void 0:e.length)>0?(c(),Q(y,{key:0,dense:"",flat:"",color:"primary","icon-right":"archive",label:"Export",class:"q-ml-sm","no-caps":"",onClick:a[1]||(a[1]=A=>W(o(x)))})):D("",!0)]}),_:1})]),_:1},8,["rows","columns","pagination","filter"])),t(re,{modelValue:m.value,"onUpdate:modelValue":a[10]||(a[10]=e=>m.value=e),persistent:""},{default:l(()=>[t(ne,{style:{width:"500px"}},{default:l(()=>[t(f,null,{default:l(()=>[k("div",Ve,n(V.value),1)]),_:1}),t(f,{class:"q-pt-none"},{default:l(()=>[t(v,{outlined:"",dense:"",label:"Name",modelValue:o(r).name,"onUpdate:modelValue":a[3]||(a[3]=e=>o(r).name=e)},null,8,["modelValue"])]),_:1}),t(f,{class:"q-pt-none"},{default:l(()=>[t(v,{outlined:"",dense:"",label:"Quantity",modelValue:o(r).quantity,"onUpdate:modelValue":a[4]||(a[4]=e=>o(r).quantity=e),type:"number"},null,8,["modelValue"])]),_:1}),t(ue,{class:"q-mb-sm"},{default:l(()=>[t(v,{outlined:"",dense:"",label:"Buying Price",modelValue:o(r).buying_price,"onUpdate:modelValue":a[5]||(a[5]=e=>o(r).buying_price=e),type:"number"},null,8,["modelValue"]),t($),t(v,{outlined:"",dense:"",label:"Selling Price",modelValue:o(r).selling_price,"onUpdate:modelValue":a[6]||(a[6]=e=>o(r).selling_price=e),type:"number"},null,8,["modelValue"])]),_:1}),t(f,{class:"q-pt-none"},{default:l(()=>[t(N,{dense:"",outlined:"",modelValue:o(r).category_id,"onUpdate:modelValue":a[7]||(a[7]=e=>o(r).category_id=e),options:o(G),"option-value":"uuid","option-label":"name",label:"Select Product Category"},null,8,["modelValue","options"])]),_:1}),t(f,{class:"q-pt-none"},{default:l(()=>[t(N,{dense:"",outlined:"",modelValue:o(r).measurement_id,"onUpdate:modelValue":a[8]||(a[8]=e=>o(r).measurement_id=e),options:o(L),"option-value":"uuid","option-label":"name",label:"Select Product Measurement"},null,8,["modelValue","options"])]),_:1}),t(f,{class:"q-pt-none"},{default:l(()=>[t(N,{dense:"",outlined:"",modelValue:o(r).department_id,"onUpdate:modelValue":a[9]||(a[9]=e=>o(r).department_id=e),options:o(O),"option-value":"uuid","option-label":"name",label:"Select Product Department"},null,8,["modelValue","options"])]),_:1}),k("div",Qe,[k("small",null,n(p.value),1)]),t(se,{align:"right"},{default:l(()=>[t(y,{flat:"",label:"Cancel",color:"red",onClick:K}),t($),o(r).name&&!g.value?(c(),Q(y,{key:0,flat:"",label:"Add Product",color:"primary",onClick:H})):D("",!0),o(r).name&&g.value?(c(),Q(y,{key:1,flat:"",label:"Edit Product",color:"primary",onClick:J})):D("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{Oe as default};
