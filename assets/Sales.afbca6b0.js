import{Q as p,a as R}from"./QTr.f2b3f0cd.js";import{r as d,aI as f,a5 as q,u as i,P as u,a3 as x,aa as j,bb as s,b as G,d as a,bD as V,bE as b,ac as v,a6 as N,a4 as T}from"./index.bc27483f.js";import{Q as $}from"./QInput.e3697c5f.js";import{Q as H,a as J,p as K,c as W,d as X}from"./paginations.fcc2a0de.js";import{a as Y,Q as B}from"./QCard.7d1d294b.js";import{e as Z,a as ee}from"./excel.5d19a2ad.js";import{a as ae}from"./use-quasar.e5ac4fd4.js";import{a as te,u as le}from"./index.4c42915d.js";import{u as se}from"./sale-store.54bd3272.js";import"./use-dark.c0bb3fd4.js";import"./QSeparator.df4475a1.js";import"./rtl.f0ddda94.js";import"./module_calls.e16012c0.js";import"./helpers.01ee3f07.js";const A=[{name:"name",required:!0,label:"Name",align:"left",field:_=>_.name,format:_=>`${_}`,sortable:!0},{name:"quantity",align:"center",label:"Quantity",field:"quantity",sortable:!0},{name:"status",align:"center",label:"Status",field:"status",sortable:!0},{name:"user",align:"center",label:"Created By",field:"user",sortable:!0},{name:"created_at",align:"center",label:"Created On",field:"created_at",sortable:!0},{name:"actions",align:"center",label:"Actions",field:"created_at"}];const re={class:"q-pa-md"},oe={key:0},ne={key:1},ie={class:"text-h6"},ue={class:"text-center error_msg"},we={__name:"Sales",setup(_){const E=ae(),k=te(),g=se(),S=K(10),c=d(!1),y=d(!1),h=d(""),Q=d(""),r=d(""),w=d(""),m=d(""),{data:C,isLoading:U,isError:D}=le("sales",()=>g.fetchSales()),I=async t=>{if(confirm(`Continue with the operation. Delete ${t.name} ?`)){const o=await g.deleteSale({uuid:t.uuid});o.status==="success"?(k.refetchQueries("sales"),n(o.message,"green","top")):n("There was an error","red","top-right")}},z=t=>{y.value=!0,Q.value=`Edit ${t.name}`,r.value=t.name,w.value=t.uuid,c.value=!0},L=async()=>{if(m.value="",r.value.trim()){const t=await g.createSale({name:r.value.trim()});t.status==="success"?(k.refetchQueries("sales"),r.value="",c.value=!1,n(t.message,"green","top")):(m.value=t.message,n(t.message,"red","top-right"))}else m.value="Name is required!",n("Name is required!","red","top-right")},F=async()=>{const t={name:r.value.trim(),uuid:w.value};if(t.name){const l=await g.updateSale(t);l.status==="success"?(k.refetchQueries("sales"),r.value="",c.value=!1,y.value=!1,Q.value="",n(l.message,"green","top")):n("There was an error","red","top-right")}else m.value="Name is required!",n("Name is required!","red","top-right")},M=()=>{c.value=!1,r.value="",w.value="",m.value=""},n=(t,l,o)=>{E.notify({message:t,color:l,position:o})},O=t=>{const l=t.map(o=>({name:o.name,sales:o.sales.length,created_at:o.created_at}));Z(l,A,ee,E,"SalesData")};return(t,l)=>{var o;return f(),q("div",re,[i(U)?(f(),q("div",oe,"Loading sales...")):i(D)?(f(),q("div",ne,"An error has occurred: "+u(i(D)),1)):(f(),x(H,{key:2,title:"Sales",rows:i(C),columns:i(A),pagination:i(S),"onUpdate:pagination":l[2]||(l[2]=e=>G(S)?S.value=e:null),separator:"cell","row-key":"name",filter:h.value,dense:""},j({body:s(e=>[a(R,{props:e},{default:s(()=>[a(p,{key:"name",props:e},{default:s(()=>[v(u(e.row.name),1)]),_:2},1032,["props"]),a(p,{key:"quantity",props:e},{default:s(()=>[v(u(e.row.quantity),1)]),_:2},1032,["props"]),a(p,{key:"status",props:e},{default:s(()=>[v(u(e.row.status),1)]),_:2},1032,["props"]),a(p,{key:"user",props:e},{default:s(()=>[v(u(e.row.user),1)]),_:2},1032,["props"]),a(p,{key:"created_at",props:e},{default:s(()=>[v(u(e.row.created_at),1)]),_:2},1032,["props"]),a(p,{key:"actions",props:e},{default:s(()=>[a(V,{color:"blue",name:"edit",onClick:P=>z(e.row),style:{cursor:"pointer"},size:"20px",class:"q-mr-md"},null,8,["onClick"]),a(V,{color:"red",name:"delete",onClick:P=>I(e.row),style:{cursor:"pointer"},size:"20px"},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:2},[((o=i(C))==null?void 0:o.length)>0?{name:"top-right",fn:s(()=>[a($,{borderless:"",dense:"",outlined:"",rounded:"",debounce:"300",modelValue:h.value,"onUpdate:modelValue":l[0]||(l[0]=e=>h.value=e),placeholder:"Search",class:"q-mr-md"},{append:s(()=>[a(V,{name:"search"})]),_:1},8,["modelValue"]),a(b,{dense:"",flat:"",color:"primary","icon-right":"archive",label:"Export",class:"q-ml-sm","no-caps":"",onClick:l[1]||(l[1]=e=>O(i(C)))})]),key:"0"}:void 0]),1032,["rows","columns","pagination","filter"])),a(J,{modelValue:c.value,"onUpdate:modelValue":l[4]||(l[4]=e=>c.value=e),persistent:""},{default:s(()=>[a(Y,{style:{width:"500px"}},{default:s(()=>[a(B,null,{default:s(()=>[N("div",ie,u(Q.value),1)]),_:1}),a(B,{class:"q-pt-none"},{default:s(()=>[a($,{outlined:"",dense:"",label:"Name",modelValue:r.value,"onUpdate:modelValue":l[3]||(l[3]=e=>r.value=e)},null,8,["modelValue"])]),_:1}),N("div",ue,[N("small",null,u(m.value),1)]),a(W,{align:"right"},{default:s(()=>[a(b,{flat:"",label:"Cancel",color:"red",onClick:M}),a(X),r.value&&!y.value?(f(),x(b,{key:0,flat:"",label:"Add Sale",color:"primary",onClick:L})):T("",!0),r.value&&y.value?(f(),x(b,{key:1,flat:"",label:"Edit Sale",color:"primary",onClick:F})):T("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{we as default};
