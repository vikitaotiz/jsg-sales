import{Q as p,a as F}from"./QTr.401870aa.js";import{r as u,aI as m,a5 as h,u as i,P as n,a3 as k,aa as M,bb as s,d as a,bD as O,bE as y,ac as _,a6 as q,a4 as E}from"./index.104f6ae1.js";import{Q as B}from"./QInput.2343ca30.js";import{Q as P,c as j,f as z,d as G}from"./QCardActions.e5ce3c72.js";import{a as H,Q as T}from"./QCard.4f99fc1d.js";import{e as J,a as K}from"./excel.5d19a2ad.js";import{a as R}from"./use-quasar.f532f3dd.js";import{a as W,u as X}from"./index.3178a3ef.js";import{u as Y}from"./sale-store.c83f31eb.js";import"./use-dark.abb6de42.js";import"./QSeparator.66c9c541.js";import"./rtl.9bf9d968.js";import"./module_calls.c637478d.js";import"./helpers.d60dad50.js";const D=[{name:"name",required:!0,label:"Name",align:"left",field:v=>v.name,format:v=>`${v}`,sortable:!0},{name:"quantity",align:"center",label:"Quantity",field:"quantity",sortable:!0},{name:"status",align:"center",label:"Status",field:"status",sortable:!0},{name:"user",align:"center",label:"Created By",field:"user",sortable:!0},{name:"created_at",align:"center",label:"Created On",field:"created_at",sortable:!0}];const Z={class:"q-pa-md"},ee={key:0},ae={key:1},te={class:"text-h6"},se={class:"text-center error_msg"},ge={__name:"Sales",setup(v){const w=R(),C=W(),g=Y(),f=u(!1),b=u(!1),Q=u(""),x=u(""),r=u(""),V=u(""),d=u(""),{data:S,isLoading:A,isError:N}=X("sales",()=>g.fetchSales()),U=async()=>{if(d.value="",r.value.trim()){const l=await g.createSale({name:r.value.trim()});l.status==="success"?(C.refetchQueries("sales"),r.value="",f.value=!1,c(l.message,"green","top")):(d.value=l.message,c(l.message,"red","top-right"))}else d.value="Name is required!",c("Name is required!","red","top-right")},I=async()=>{const l={name:r.value.trim(),uuid:V.value};if(l.name){const t=await g.updateSale(l);t.status==="success"?(C.refetchQueries("sales"),r.value="",f.value=!1,b.value=!1,x.value="",c(t.message,"green","top")):c("There was an error","red","top-right")}else d.value="Name is required!",c("Name is required!","red","top-right")},$=()=>{f.value=!1,r.value="",V.value="",d.value=""},c=(l,t,o)=>{w.notify({message:l,color:t,position:o})},L=l=>{const t=l.map(o=>({name:o.name,sales:o.sales.length,created_at:o.created_at}));J(t,D,K,w,"SalesData")};return(l,t)=>{var o;return m(),h("div",Z,[i(A)?(m(),h("div",ee,"Loading sales...")):i(N)?(m(),h("div",ae,"An error has occurred: "+n(i(N)),1)):(m(),k(P,{key:2,title:"Sales",rows:i(S),columns:i(D),separator:"cell","row-key":"name",filter:Q.value,dense:""},M({body:s(e=>[a(F,{props:e},{default:s(()=>[a(p,{key:"name",props:e},{default:s(()=>[_(n(e.row.name),1)]),_:2},1032,["props"]),a(p,{key:"quantity",props:e},{default:s(()=>[_(n(e.row.quantity),1)]),_:2},1032,["props"]),a(p,{key:"status",props:e},{default:s(()=>[_(n(e.row.status),1)]),_:2},1032,["props"]),a(p,{key:"user",props:e},{default:s(()=>[_(n(e.row.user),1)]),_:2},1032,["props"]),a(p,{key:"created_at",props:e},{default:s(()=>[_(n(e.row.created_at),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:2},[((o=i(S))==null?void 0:o.length)>0?{name:"top-right",fn:s(()=>[a(B,{borderless:"",dense:"",outlined:"",rounded:"",debounce:"300",modelValue:Q.value,"onUpdate:modelValue":t[0]||(t[0]=e=>Q.value=e),placeholder:"Search",class:"q-mr-md"},{append:s(()=>[a(O,{name:"search"})]),_:1},8,["modelValue"]),a(y,{dense:"",flat:"",color:"primary","icon-right":"archive",label:"Export",class:"q-ml-sm","no-caps":"",onClick:t[1]||(t[1]=e=>L(i(S)))})]),key:"0"}:void 0]),1032,["rows","columns","filter"])),a(j,{modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=e=>f.value=e),persistent:""},{default:s(()=>[a(H,{style:{width:"500px"}},{default:s(()=>[a(T,null,{default:s(()=>[q("div",te,n(x.value),1)]),_:1}),a(T,{class:"q-pt-none"},{default:s(()=>[a(B,{outlined:"",dense:"",label:"Name",modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=e=>r.value=e)},null,8,["modelValue"])]),_:1}),q("div",se,[q("small",null,n(d.value),1)]),a(z,{align:"right"},{default:s(()=>[a(y,{flat:"",label:"Cancel",color:"red",onClick:$}),a(G),r.value&&!b.value?(m(),k(y,{key:0,flat:"",label:"Add Sale",color:"primary",onClick:U})):E("",!0),r.value&&b.value?(m(),k(y,{key:1,flat:"",label:"Edit Sale",color:"primary",onClick:I})):E("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{ge as default};
